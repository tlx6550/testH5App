!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e=e||self).CallApp=n()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,n){return e(n={exports:{}},n.exports),n.exports}var v=n(function(e){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)}),y=n(function(e){var n=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=n)}),m=(y.version,function(r,o,e){if(function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!")}(r),void 0===o)return r;switch(e){case 1:return function(e){return r.call(o,e)};case 2:return function(e,n){return r.call(o,e,n)};case 3:return function(e,n,t){return r.call(o,e,n,t)}}return function(){return r.apply(o,arguments)}}),o=function(e){return"object"==typeof e?null!==e:"function"==typeof e},r=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e},t=function(e){try{return!!e()}catch(e){return!0}},i=!t(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),u=v.document,a=o(u)&&o(u.createElement),c=!i&&!t(function(){return 7!=Object.defineProperty((e="div",a?u.createElement(e):{}),"a",{get:function(){return 7}}).a;var e}),f=Object.defineProperty,s={f:i?Object.defineProperty:function(e,n,t){if(r(e),n=function(e,n){if(!o(e))return e;var t,r;if(n&&"function"==typeof(t=e.toString)&&!o(r=t.call(e)))return r;if("function"==typeof(t=e.valueOf)&&!o(r=t.call(e)))return r;if(!n&&"function"==typeof(t=e.toString)&&!o(r=t.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(n,!0),r(t),c)try{return f(e,n,t)}catch(e){}if("get"in t||"set"in t)throw TypeError("Accessors not supported!");return"value"in t&&(e[n]=t.value),e}},b=i?function(e,n,t){return s.f(e,n,{enumerable:!((r=1)&r),configurable:!(2&r),writable:!(4&r),value:t});var r}:function(e,n,t){return e[n]=t,e},l={}.hasOwnProperty,g=function(e,n){return l.call(e,n)},O="prototype",_=function(e,n,t){var r,o,i,u=e&_.F,a=e&_.G,c=e&_.S,f=e&_.P,s=e&_.B,l=e&_.W,p=a?y:y[n]||(y[n]={}),d=p[O],h=a?v:c?v[n]:(v[n]||{})[O];for(r in a&&(t=n),t)(o=!u&&h&&void 0!==h[r])&&g(p,r)||(i=o?h[r]:t[r],p[r]=a&&"function"!=typeof h[r]?t[r]:s&&o?m(i,v):l&&h[r]==i?function(r){var e=function(e,n,t){if(this instanceof r){switch(arguments.length){case 0:return new r;case 1:return new r(e);case 2:return new r(e,n)}return new r(e,n,t)}return r.apply(this,arguments)};return e[O]=r[O],e}(i):f&&"function"==typeof i?m(Function.call,i):i,f&&((p.virtual||(p.virtual={}))[r]=i,e&_.R&&d&&!d[r]&&b(d,r,i)))};_.F=1,_.G=2,_.S=4,_.P=8,_.B=16,_.W=32,_.U=64,_.R=128;var p,d,h,w=_,k={}.toString,j=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==(n=e,k.call(n).slice(8,-1))?e.split(""):Object(e);var n},S=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},C=function(e){return j(S(e))},M=Math.ceil,T=Math.floor,E=function(e){return isNaN(e=+e)?0:(0<e?T:M)(e)},x=Math.min,P=Math.max,I=Math.min,F=n(function(e){var n="__core-js_shared__",t=v[n]||(v[n]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:y.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),U=0,A=Math.random(),z=F("keys"),R=(p=!1,function(e,n,t){var r,o,i,u,a=C(e),c=0<(r=a.length)?x(E(r),9007199254740991):0,f=(i=c,(o=E(o=t))<0?P(o+i,0):I(o,i));if(p&&n!=n){for(;f<c;)if((u=a[f++])!=u)return!0}else for(;f<c;f++)if((p||f in a)&&a[f]===n)return p||f||0;return!p&&-1}),W=z[d="IE_PROTO"]||(z[d]="Symbol(".concat(void 0===(h=d)?"":h,")_",(++U+A).toString(36))),q="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),L=Object.keys||function(e){return function(e,n){var t,r=C(e),o=0,i=[];for(t in r)t!=W&&g(r,t)&&i.push(t);for(;n.length>o;)g(r,t=n[o++])&&(~R(i,t)||i.push(t));return i}(e,q)},Q={f:Object.getOwnPropertySymbols},B={f:{}.propertyIsEnumerable},Y=function(e){return Object(S(e))},G=Object.assign,H=!G||t(function(){var e={},n={},t=Symbol(),r="abcdefghijklmnopqrst";return e[t]=7,r.split("").forEach(function(e){n[e]=e}),7!=G({},e)[t]||Object.keys(G({},n)).join("")!=r})?function(e,n){for(var t=Y(e),r=arguments.length,o=1,i=Q.f,u=B.f;o<r;)for(var a,c=j(arguments[o++]),f=i?L(c).concat(i(c)):L(c),s=f.length,l=0;l<s;)u.call(c,a=f[l++])&&(t[a]=c[a]);return t}:G;w(w.S+w.F,"Object",{assign:H});var N=y.Object.assign,V=e(n(function(e){e.exports={default:N,__esModule:!0}})),D=e(n(function(e,n){n.__esModule=!0,n.default=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}}));w(w.S+w.F*!i,"Object",{defineProperty:s.f});var K=y.Object,$=function(e,n,t){return K.defineProperty(e,n,t)},J=n(function(e){e.exports={default:$,__esModule:!0}});e(J);var X=e(n(function(e,n){n.__esModule=!0;var t,o=(t=J)&&t.__esModule?t:{default:t};n.default=function(){function r(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),(0,o.default)(e,r.key,r)}}return function(e,n,t){return n&&r(e.prototype,n),t&&r(e,t),e}}()}));var Z,ee,ne,te;Z="keys",ee=function(){return function(e){return L(Y(e))}},ne=(y.Object||{})[Z]||Object[Z],(te={})[Z]=ee(ne),w(w.S+w.F*t(function(){ne(1)}),"Object",te);var re=y.Object.keys,oe=e(n(function(e){e.exports={default:re,__esModule:!0}}));function ie(e,n){var t=e.path,r=e.param,o=n.buildScheme;if(void 0!==o)return o(e,n);var i=n.scheme,u=i.host,a=i.port,c=i.protocol,f=u?""+u+(a?":"+a:"")+"/":"",s=void 0!==r?oe(r).map(function(e){return e+"="+r[e]}).join("&"):"";return c+"://"+f+t+(s?"?"+s:"")}function ue(e,n){var t=n.outChain,r=ie(e,n);void 0!==t&&t&&(r=t.protocol+"://"+t.path+"?"+t.key+"="+encodeURIComponent(r));return r}var ae=null;function ce(){var n=void 0;return"hidden"in document?"":(["webkit","moz","ms","o"].forEach(function(e){e+"Hidden"in document&&(n=e)}),n||!1)}function fe(e){window.top.location.href=e}function se(e){ae||((ae=document.createElement("iframe")).frameborder="0",ae.style.cssText="display:none;border:0;width:0;height:0;",document.body.appendChild(ae)),ae.src=e}function le(n,e){var t,r=!1!==(t=ce())&&t+"visibilitychange",o=setTimeout(function(){var e;!1!==(e=ce())&&document[e?e+"Hidden":"hidden"]||n()},e);r?document.addEventListener(r,function(){clearTimeout(o)}):window.addEventListener("pagehide",function(){clearTimeout(o)})}return function(){function n(e){D(this,n);this.options=V({timeout:2e3},e)}return X(n,[{key:"generateScheme",value:function(e){return ue(e,this.options)}},{key:"generateIntent",value:function(e){return function(e,n){var t=n.outChain,r=n.intent,o=n.fallback,i="#Intent;"+oe(r).map(function(e){return e+"="+r[e]+";"}).join("")+"S.browser_fallback_url="+encodeURIComponent(o)+";end;",u=ie(e,n);if(void 0!==t&&t){var a=n.outChain;return"intent://"+a.path+"?"+a.key+"="+encodeURIComponent(u)+i}return"intent://"+(u=u.slice(u.indexOf("//")+2))+i}(e,this.options)}},{key:"generateUniversalLink",value:function(e){return function(e,n){var t=n.universal;if(!t)return"";var r=t.host,o=t.pathKey,i=e.path,u=e.param,a=void 0!==u?oe(u).map(function(e){return e+"="+u[e]}).join("&"):"";return"https://"+r+"?"+o+"="+i+(a?"&"+a:"")}(e,this.options)}},{key:"generateYingYongBao",value:function(e){return n=e,t=this.options,r=ue(n,t),t.yingyongbao+"&android_schema="+encodeURIComponent(r);var n,t,r}},{key:"checkOpen",value:function(e){return le(e,this.options.timeout)}},{key:"fallToAppStore",value:function(){var e=this;this.checkOpen(function(){fe(e.options.appstore)})}},{key:"fallToFbUrl",value:function(){var e=this;this.checkOpen(function(){fe(e.options.fallback)})}},{key:"fallToCustomCb",value:function(e){this.checkOpen(function(){e()})}},{key:"open",value:function(e){var n,t,r,o,i,u,a=(n=window.navigator.userAgent||"",t=/android/i.test(n),r=/iphone|ipad|ipod/i.test(n),{isAndroid:t,isIos:r,isWechat:/micromessenger\/([\d.]+)/i.test(n),isWeibo:/(weibo).*weibo__([\d.]+)/i.test(n),isQQ:/qq\/([\d.]+)/i.test(n),isQzone:/qzone\/.*_qz_([\d.]+)/i.test(n),isOriginalChrome:/chrome\/[\d.]+ Mobile Safari\/[\d.]+/i.test(n)&&t&&n.indexOf("Version")<0,isSafari:/safari\/([\d.]+)$/i.test(n)&&r&&n.indexOf("Crios")<0&&0===n.indexOf("Mozilla")}),c=this.options,f=c.universal,s=c.appstore,l=c.logFunc,p=c.intent,d=e.callback,h=void 0!==f,v=this.generateScheme(e),y=null;void 0!==l&&l(),a.isIos?a.isWechat||a.isQQ?fe(s):(u=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),parseInt(u[1],10)<9?(se(v),y=this.fallToAppStore):h?fe(this.generateUniversalLink(e)):(fe(v),y=this.fallToAppStore)):a.isWechat?fe(this.generateYingYongBao(e)):a.isOriginalChrome?void 0!==p?fe(this.generateIntent(e)):(o=v,(i=document.createElement("a")).setAttribute("href",o),i.style.display="none",document.body.appendChild(i),i.click(),y=this.fallToFbUrl):(se(v),y=this.fallToFbUrl),void 0===d?y&&y.call(this):this.fallToCustomCb(d)}}]),n}()});
